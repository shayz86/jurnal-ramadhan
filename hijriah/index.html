<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<title>Kalender Hijriyah</title>

<link rel="stylesheet" href="hijriah.css" />

</head>
<body>

<!-- HEADER -->
<div class="hijri-header">
  <button onclick="history.back()">â†</button>
  <h1>Kalender Hijriyah</h1>
  <span>ğŸ“…</span>
</div>

<!-- MONTH NAV -->
<div class="hijri-month-nav">
  <button id="prevMonth">â€¹</button>
  <span id="monthTitle"></span>
  <button id="nextMonth">â€º</button>
</div>

<!-- WEEK DAYS -->
<div class="hijri-weekdays">
  <div>Sen</div>
  <div>Sel</div>
  <div>Rab</div>
  <div>Kam</div>
  <div>Jum</div>
  <div>Sab</div>
  <div>Min</div>
</div>

<!-- GRID -->
<div id="calendarGrid" class="hijri-grid"></div>

<script>
let currentDate = new Date();

const grid = document.getElementById("calendarGrid");
const monthTitle = document.getElementById("monthTitle");

const hijriFormatter = new Intl.DateTimeFormat("id-TN-u-ca-islamic", {
  day: "numeric",
  month: "long",
  year: "numeric"
});

const gregFormatter = new Intl.DateTimeFormat("id-ID", {
  day: "numeric"
});

function renderCalendar(date) {
  grid.innerHTML = "";

  const year = date.getFullYear();
  const month = date.getMonth();

  const firstDay = new Date(year, month, 1);
  const startDay = (firstDay.getDay() + 6) % 7;

  const daysInMonth = new Date(year, month + 1, 0).getDate();

  const hijriParts = hijriFormatter.formatToParts(date);
  const hijriMonth = hijriParts.find(p => p.type === "month")?.value;
  const hijriYear = hijriParts.find(p => p.type === "year")?.value;

  monthTitle.textContent = `${hijriMonth} ${hijriYear}`;

  for (let i = 0; i < startDay; i++) {
    grid.appendChild(document.createElement("div"));
  }

  for (let d = 1; d <= daysInMonth; d++) {

    const cellDate = new Date(year, month, d);

    const hijriDay = new Intl.DateTimeFormat(
      "ar-TN-u-ca-islamic",
      { day: "numeric" }
    ).format(cellDate);

    const gregDay = gregFormatter.format(cellDate);

    const div = document.createElement("div");
    div.className = "hijri-day";

    const today = new Date();
    if (
      cellDate.toDateString() === today.toDateString()
    ) {
      div.classList.add("today");
    }

    div.innerHTML = `
      <div class="greg">${gregDay}</div>
      <div class="hijri">${hijriDay}</div>
    `;

    grid.appendChild(div);
  }
}

document.getElementById("prevMonth").onclick = () => {
  currentDate.setMonth(currentDate.getMonth() - 1);
  renderCalendar(currentDate);
};

document.getElementById("nextMonth").onclick = () => {
  currentDate.setMonth(currentDate.getMonth() + 1);
  renderCalendar(currentDate);
};

renderCalendar(currentDate);
</script>

</body>
</html>
