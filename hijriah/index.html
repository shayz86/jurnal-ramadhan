<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Kalender Hijriah</title>

<link rel="stylesheet" href="hijriah.css" />

</head>
<body>

<header class="topbar">
  <button onclick="history.back()" class="back">â†</button>
  <h1>Kalender Hijriah</h1>

  <button id="openPuasa" class="calendarBtn">ğŸ“…</button>
</header>

<section class="monthNav">
  <button id="prevMonth">â€¹</button>
  <h2 id="monthTitle">-</h2>
  <button id="nextMonth">â€º</button>
</section>

<div class="weekday">
  <span>Sen</span>
  <span>Sel</span>
  <span>Rab</span>
  <span>Kam</span>
  <span>Jum</span>
  <span>Sab</span>
  <span>Min</span>
</div>

<div id="calendarGrid" class="calendar-grid"></div>

<!-- ================= POPUP PUASA ================= -->

<div id="puasaPopup" class="puasa-popup">

  <header class="puasa-header">
    <button onclick="closePuasa()">â†</button>
    <h2>Puasa Sunnah</h2>
  </header>

  <div class="puasa-list">

    <div class="puasa-item">
      <h4>Awal Bulan Rajab (Bulan Mulia) 1447 H</h4>
      <span>21 Desember</span>
    </div>

    <div class="puasa-item">
      <h4>Puasa Ayyamul Bidh Jumadilâ€“Akhirah 1447 H</h4>
      <span>6 Desember</span>
    </div>

    <div class="puasa-item">
      <h4>Puasa Ayyamul Bidh Jumadilâ€“Akhirah 1447 H</h4>
      <span>5 Desember</span>
    </div>

    <div class="puasa-item">
      <h4>Puasa Ayyamul Bidh Jumadilâ€“Akhirah 1447 H</h4>
      <span>4 Desember</span>
    </div>

    <div class="puasa-item">
      <h4>Awal Bulan Jumadilâ€“Akhirah 1447 H</h4>
      <span>22 November</span>
    </div>

    <div class="puasa-item">
      <h4>Puasa Ayyamul Bidh Jumadilâ€“Ula 1447 H</h4>
      <span>6 November</span>
    </div>

    <div class="puasa-item">
      <h4>Puasa Ayyamul Bidh Jumadilâ€“Ula 1447 H</h4>
      <span>5 November</span>
    </div>

    <div class="puasa-item">
      <h4>Puasa Ayyamul Bidh Jumadilâ€“Ula 1447 H</h4>
      <span>4 November</span>
    </div>

    <div class="puasa-item">
      <h4>Awal Bulan Jumadilâ€“Ula 1447 H</h4>
      <span>23 Oktober</span>
    </div>

    <div class="puasa-item">
      <h4>Puasa Ayyamul Bidh Rabi'ulâ€“Akhir 1447 H</h4>
      <span>7 Oktober</span>
    </div>

  </div>

</div>

<!-- ================= SCRIPT ================= -->

<script>

const arabNums=["Ù ","Ù¡","Ù¢","Ù£","Ù¤","Ù¥","Ù¦","Ù§","Ù¨","Ù©"];

function toArabic(num){
 return num.toString().split("").map(n=>arabNums[n]).join("");
}

const hijriMonths=[
 "Muharram","Safar","Rabi'ul Awal","Rabi'ul Akhir",
 "Jumadal Ula","Jumadal Akhirah",
 "Rajab","Sha'ban","Ramadhan",
 "Syawal","Dzulqa'dah","Dzulhijjah"
];

const grid=document.getElementById("calendarGrid");
const monthTitle=document.getElementById("monthTitle");

function getHijriParts(date){

 const fmt=new Intl.DateTimeFormat(
  "en-TN-u-ca-islamic",
  {day:"numeric",month:"numeric",year:"numeric"}
 );

 const parts=fmt.formatToParts(date);
 const obj={};

 parts.forEach(p=>{
  if(p.type!=="literal") obj[p.type]=parseInt(p.value);
 });

 return obj;
}

let baseDate=new Date();

/* ===== simpan hijri today asli ===== */
const todayHijri=getHijriParts(new Date());

/* ================= RENDER ================= */

function renderCalendar(){

 grid.innerHTML="";

 const hijri=getHijriParts(baseDate);

 const hMonth=hijri.month-1;
 const hYear=hijri.year;

 monthTitle.textContent=
  hijriMonths[hMonth]+" "+hYear+" H";

 // cari masehi awal bulan hijriah
 const firstDayDate=new Date(baseDate);
 firstDayDate.setDate(
  baseDate.getDate()-(hijri.day-1)
 );

 const startOffset=firstDayDate.getDay()===0
  ?6:firstDayDate.getDay()-1;

 for(let i=0;i<startOffset;i++){
  grid.appendChild(document.createElement("div"));
 }

 const daysInMonth=30;

 for(let d=1;d<=daysInMonth;d++){

  const cell=document.createElement("div");
  cell.className="hijri-day";

  const g=document.createElement("div");
  g.className="greg";

  const mDate=new Date(firstDayDate);
  mDate.setDate(firstDayDate.getDate()+d-1);

  g.textContent=mDate.getDate();

  const h=document.createElement("div");
  h.className="hijri";
  h.textContent=toArabic(d);

  /* highlight ONLY jika bulan+tahun sama */
  if(
    hijri.month===todayHijri.month &&
    hijri.year===todayHijri.year &&
    d===todayHijri.day
  ){
    cell.classList.add("today");
  }

  cell.append(g,h);
  grid.appendChild(cell);
 }
}

renderCalendar();

/* ================= NAV ================= */

document.getElementById("prevMonth").onclick=()=>{
 baseDate.setDate(baseDate.getDate()-30);
 renderCalendar();
};

document.getElementById("nextMonth").onclick=()=>{
 baseDate.setDate(baseDate.getDate()+30);
 renderCalendar();
};

/* ================= POPUP ================= */

const popup=document.getElementById("puasaPopup");

document.getElementById("openPuasa").onclick=()=>{
 popup.classList.add("show");
};

function closePuasa(){
 popup.classList.remove("show");
}

</script>

</body>
</html>
